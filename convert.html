<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="무료로 다양한 파일 형식을 변환하세요. 이미지, 문서, 오디오, 데이터 파일을 쉽고 빠르게 변환합니다.">
    <meta name="keywords" content="파일 변환, 이미지 변환, PDF 변환, 문서 변환, 온라인 변환, 무료 변환">
    <title>파일 변환 - FileToQR</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/components/file-uploader.css">
    <link rel="stylesheet" href="assets/css/components/converter.css">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 툴팁 스타일 */
        .help-tooltip {
            z-index: 1000;
            max-width: 300px;
        }
        
        /* 드래그 오버 스타일 */
        .dropzone.dragover {
            border-color: #3B82F6;
            background-color: rgba(59, 130, 246, 0.05);
        }
        
        /* 진행 단계 스타일 */
        .step-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
        }
        
        /* 피드백 이모지 스타일 */
        .feedback-rating {
            font-size: 2rem;
            cursor: pointer;
            opacity: 0.7;
            transition: transform 0.2s, opacity 0.2s;
        }
        
        .feedback-rating:hover,
        .feedback-rating.selected {
            opacity: 1;
            transform: scale(1.2);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col">
    <!-- 헤더 컴포넌트 -->
    <div id="header-container"></div>

    <main class="flex-grow container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold mb-6">파일 변환</h1>
        
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="mb-6">
                <h2 class="text-xl font-semibold mb-4">파일 업로드</h2>
                <div id="dropzone" class="dropzone p-8 text-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-gray-400 transition-colors">
                    <div class="mb-4">
                        <svg class="w-16 h-16 mx-auto text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                    </div>
                    <p class="text-lg mb-2">파일을 여기에 드래그하거나 클릭하여 업로드</p>
                    <p class="text-sm text-gray-500 mb-4">모든 파일 처리는 브라우저에서 이루어집니다. 파일이 서버로 전송되지 않습니다.</p>
                    <input type="file" id="file-input" class="hidden" />
                    <button id="select-file-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md">파일 선택</button>
                </div>
            </div>

            <div id="conversion-options" class="hidden mb-6">
                <h2 class="text-xl font-semibold mb-4">변환 옵션</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- 왼쪽 열: 파일 정보 -->
                    <div>
                        <div class="border rounded-md p-4">
                            <h3 class="font-medium mb-2">파일 정보</h3>
                            <div class="space-y-2 text-sm">
                                <div class="flex">
                                    <span class="text-gray-500 w-24">파일명:</span>
                                    <span id="file-name" class="font-medium"></span>
                                </div>
                                <div class="flex">
                                    <span class="text-gray-500 w-24">형식:</span>
                                    <span id="file-type" class="font-medium"></span>
                                </div>
                                <div class="flex">
                                    <span class="text-gray-500 w-24">크기:</span>
                                    <span id="file-size" class="font-medium"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 오른쪽 열: 변환 설정 -->
                    <div>
                        <div class="border rounded-md p-4">
                            <h3 class="font-medium mb-2">변환 설정</h3>
                            
                            <div class="space-y-4">
                                <div>
                                    <label for="output-format" class="block text-sm font-medium text-gray-700 mb-1">출력 형식</label>
                                    <select id="output-format" class="w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                                        <option value="">형식 선택</option>
                                        <!-- 자바스크립트로 동적 생성 -->
                                    </select>
                                </div>
                                
                                <div id="format-specific-options">
                                    <!-- 선택된 형식에 따라 동적으로 옵션 표시 -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="conversion-actions" class="hidden text-center">
                <button id="convert-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium">변환하기</button>
            </div>
        </div>

        <!-- 변환 진행 상태 -->
        <div id="conversion-progress" class="hidden bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4">변환 진행 중...</h2>
            <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                <div id="progress-bar" class="bg-blue-600 h-4 rounded-full" style="width: 0%"></div>
            </div>
            <p id="progress-text" class="text-center text-gray-600">준비 중...</p>
            <!-- 상세 진행 단계는 자바스크립트로 동적 추가됨 -->
        </div>

        <!-- 변환 결과 -->
        <div id="conversion-result" class="hidden bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4">변환 완료</h2>
            
            <div class="mb-6 p-4 border rounded-md">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 id="result-file-name" class="font-medium"></h3>
                        <p id="result-file-info" class="text-sm text-gray-500"></p>
                    </div>
                    <div class="flex space-x-2">
                        <button id="download-btn" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md">다운로드</button>
                        <button id="convert-to-qr-btn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md">QR 코드 생성</button>
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button id="convert-another-btn" class="text-blue-600 hover:underline">다른 파일 변환하기</button>
            </div>
            <!-- 피드백 UI는 자바스크립트로 동적 추가됨 -->
        </div>
        
        <!-- 광고 삽입 위치 -->
        <div id="ad-placement" class="my-8"></div>

        <section class="py-8">
            <h2 class="text-2xl font-bold mb-4">파일 변환 가이드</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="text-blue-600 mb-2">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">파일 선택</h3>
                    <p class="text-gray-600">변환하려는 파일을 드래그앤드롭하거나 파일 선택 버튼을 클릭하여 업로드합니다. 파일은 서버로 전송되지 않고 브라우저에서 처리됩니다.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="text-blue-600 mb-2">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">옵션 설정</h3>
                    <p class="text-gray-600">원하는 출력 형식과 추가 옵션을 선택합니다. 파일 유형에 따라 적절한 옵션이 자동으로 제공됩니다.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="text-blue-600 mb-2">
                        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold mb-2">변환 및 다운로드</h3>
                    <p class="text-gray-600">변환 버튼을 클릭하여 처리를 시작합니다. 변환이 완료되면 결과 파일을 다운로드할 수 있습니다.</p>
                </div>
            </div>
        </section>
    </main>

    <!-- 푸터 컴포넌트 -->
    <div id="footer-container"></div>

    <!-- 코어 스크립트 -->
    <script src="assets/js/core/app-core.js" type="module"></script>
    
    <!-- 외부 의존성 먼저 로드 -->
    <script>
        // 모듈 로딩 상태 추적
        window.FileToQR = window.FileToQR || {};
        window.FileToQR.moduleStatus = {
            fileConverterLoaded: false,
            initialized: false
        };
        
        // 콘솔에 로그 표시
        console.log('파일 변환 페이지 초기화 중...');
    </script>
    
    <!-- QR 라이브러리 직접 로드 -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <!-- 파일 유틸리티 모듈 -->
    <script src="assets/js/utils/file-utils.js" type="module"></script>
    
    <!-- 파일 변환기 모듈 (비모듈 방식으로 로드) -->
    <script>
        // 비모듈 방식으로 직접 스크립트 로드
        function loadScript(url, callback) {
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = url;
            script.onload = function() {
                console.log(`스크립트 로드 성공: ${url}`);
                if (callback) callback(true);
            };
            script.onerror = function(e) {
                console.error(`스크립트 로드 실패: ${url}`, e);
                if (callback) callback(false);
            };
            document.head.appendChild(script);
        }
        
        // 파일 변환기 스크립트 로드
        loadScript('assets/js/converters/file-converter.js', function(success) {
            window.FileToQR.moduleStatus.fileConverterLoaded = success;
            
            if (success && window.FileToQR.FileConverter) {
                console.log('파일 변환기 로드 완료, 초기화 시작...');
                window.FileToQR.FileConverter.init().then(function(initSuccess) {
                    console.log('파일 변환기 초기화 ' + (initSuccess ? '성공' : '실패'));
                    window.FileToQR.moduleStatus.initialized = initSuccess;
                    
                    // 변환 버튼에 이벤트 리스너 추가
                    const convertBtn = document.getElementById('convert-btn');
                    if (convertBtn) {
                        convertBtn.addEventListener('click', function() {
                            if (window.FileToQR.FileConverter) {
                                console.log('변환 버튼 클릭됨');
                                try {
                                    window.FileToQR.FileConverter.convertFile();
                                } catch (error) {
                                    console.error('파일 변환 중 오류 발생:', error);
                                    alert('파일 변환 중 오류가 발생했습니다.');
                                }
                            } else {
                                alert('파일 변환기가 로드되지 않았습니다.');
                            }
                        });
                    }
                });
            } else {
                console.error('파일 변환기 로드 실패');
                // 기본 UI 설정
                setupBasicUI();
            }
        });
    </script>
    
    <!-- 변환 기능 초기화 스크립트 -->
    <script>
        // 디버그 모드 활성화
        function activateDebugMode() {
            console.log('디버그 모드 활성화 시도');
            try {
                if (window.FileToQR.DebugHelper) {
                    window.FileToQR.DebugHelper.setDebugMode(true);
                    console.log('디버그 모드가 활성화되었습니다.');
                    return window.FileToQR.DebugHelper;
                }
            } catch (error) {
                console.error('디버그 모드 활성화 실패:', error);
            }
            return null;
        }
        
        // 로드 오류 표시 함수
        function showLoadError(error) {
            const options = document.getElementById('conversion-options');
            if (options) {
                options.innerHTML = `
                    <div class="p-4 bg-red-100 text-red-800 rounded-lg">
                        <h3 class="font-medium mb-2">파일 변환 기능을 로드할 수 없습니다</h3>
                        <p>기술적 문제로 파일 변환 기능을 현재 사용할 수 없습니다. 나중에 다시 시도해 주세요.</p>
                        <p class="text-sm mt-2">오류: ${error?.message || '알 수 없는 오류'}</p>
                    </div>
                `;
                options.classList.remove('hidden');
            }
        }
        
        // 기본 UI 설정 함수 (모듈 없이도 파일 선택 및 정보 표시 가능)
        function setupBasicUI() {
            // 파일 드래그 앤 드롭 이벤트 처리
            const dropzone = document.getElementById('dropzone');
            const fileInput = document.getElementById('file-input');
            const selectFileBtn = document.getElementById('select-file-btn');
            
            if (dropzone && fileInput && selectFileBtn) {
                // 파일 선택 버튼 클릭 이벤트
                selectFileBtn.addEventListener('click', () => {
                    // 단순히 파일 입력 클릭 이벤트 트리거
                    fileInput.click();
                });
                
                // 파일 선택 이벤트
                fileInput.addEventListener('change', (e) => {
                    if (e.target.files && e.target.files[0]) {
                        handleFileSelect(e.target.files[0]);
                    }
                });
                
                // 드래그 오버 이벤트
                dropzone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropzone.classList.add('dragover');
                });
                
                // 드래그 리브 이벤트
                dropzone.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropzone.classList.remove('dragover');
                });
                
                // 드롭 이벤트
                dropzone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    dropzone.classList.remove('dragover');
                    
                    if (e.dataTransfer.files && e.dataTransfer.files[0]) {
                        handleFileSelect(e.dataTransfer.files[0]);
                    }
                });
                
                console.log('기본 파일 업로드 UI 설정 완료');
            }
        }
        
        // 파일 선택 처리 함수
        function handleFileSelect(file) {
            console.log('파일 선택됨:', file.name);
            
            // 파일 정보 표시
            const fileNameEl = document.getElementById('file-name');
            const fileTypeEl = document.getElementById('file-type');
            const fileSizeEl = document.getElementById('file-size');
            
            if (fileNameEl) fileNameEl.textContent = file.name;
            if (fileTypeEl) fileTypeEl.textContent = file.type || '알 수 없는 형식';
            
            // 파일 크기 포맷팅
            const formatSize = (bytes) => {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            };
            
            if (fileSizeEl) fileSizeEl.textContent = formatSize(file.size);
            
            // 변환 옵션과 액션 버튼 표시
            const optionsEl = document.getElementById('conversion-options');
            const actionsEl = document.getElementById('conversion-actions');
            
            if (optionsEl) optionsEl.classList.remove('hidden');
            if (actionsEl) actionsEl.classList.remove('hidden');
            
            // 파일 정보 섹션에 직접 표시 (백업 방법)
            const fileInfoDiv = document.getElementById('file-info');
            if (fileInfoDiv) {
                fileInfoDiv.innerHTML = `
                    <div class="mt-4 p-4 bg-gray-100 rounded-lg">
                        <h3 class="font-medium">파일 정보</h3>
                        <p>이름: ${file.name}</p>
                        <p>크기: ${formatSize(file.size)}</p>
                        <p>형식: ${file.type || '알 수 없는 형식'}</p>
                    </div>
                `;
            }
            
            // 파일 확장자에 따른 기본 출력 형식 업데이트
            updateBasicOutputFormats(file);
        }
        
        // 기본 출력 형식 업데이트 (FileConverter 없이도 작동)
        function updateBasicOutputFormats(file) {
            const formatSelector = document.getElementById('output-format');
            if (!formatSelector) return;
            
            const extension = file.name.split('.').pop().toLowerCase();
            
            // 선택기 초기화
            formatSelector.innerHTML = '<option value="">형식 선택</option>';
            
            // 기본 지원 형식 맵 (FileConverter가 없을 때 사용)
            const basicFormatMap = {
                'png': ['jpg', 'webp', 'gif'],
                'jpg': ['png', 'webp', 'gif'],
                'jpeg': ['png', 'webp', 'gif'],
                'webp': ['png', 'jpg', 'gif'],
                'gif': ['png', 'jpg', 'webp'],
                'pdf': ['txt'],
                'txt': ['pdf'],
                'json': ['csv', 'xml'],
                'csv': ['json', 'xml'],
                'xml': ['json', 'csv']
            };
            
            const supportedFormats = basicFormatMap[extension] || [];
            
            if (supportedFormats.length > 0) {
                supportedFormats.forEach(format => {
                    const option = document.createElement('option');
                    option.value = format;
                    option.textContent = format.toUpperCase();
                    formatSelector.appendChild(option);
                });
                formatSelector.disabled = false;
            } else {
                const option = document.createElement('option');
                option.value = "";
                option.textContent = "지원되는 형식 없음";
                formatSelector.appendChild(option);
                formatSelector.disabled = true;
            }
        }
        
        // DOM이 로드된 후 초기화
        document.addEventListener('DOMContentLoaded', function() {
            console.log('페이지 로드 완료, 초기화 시작...');
            
            // 디버그 모드 활성화
            activateDebugMode();
            
            // 브라우저 환경 정보 출력
            console.log('브라우저 환경:', {
                userAgent: navigator.userAgent,
                language: navigator.language,
                cookiesEnabled: navigator.cookieEnabled,
                baseURL: window.location.origin,
                currentURL: window.location.href
            });
            
            // 항상 기본 UI 먼저 설정 (모듈이 로드되지 않아도 기본 동작 가능)
            setupBasicUI();
            
            // 이벤트 로깅 함수
            const logEventListeners = () => {
                const fileInput = document.getElementById('file-input');
                const selectFileBtn = document.getElementById('select-file-btn');
                console.log('UI 요소 상태:', {
                    fileInputExists: !!fileInput,
                    selectFileBtnExists: !!selectFileBtn,
                    hasDragDropZone: !!document.getElementById('dropzone')
                });
            };
            
            // 1초 후 UI 요소 상태 확인
            setTimeout(logEventListeners, 1000);
        });
    </script>
    
    <!-- 이미지 변환 구현 (팔백) -->
    <script>
    // 로컬 스크립트를 사용한 폴백 파일 변환 기능 구현
    document.addEventListener('DOMContentLoaded', function() {
        // 변환 버튼 이벤트
        const convertBtn = document.getElementById('convert-btn');
        if (convertBtn) {
            convertBtn.addEventListener('click', function() {
                // 모듈이 로드되었으면 이 핸들러는 무시됨 (중복 방지)
                if (window.FileToQR && window.FileToQR.moduleStatus && window.FileToQR.moduleStatus.initialized) {
                    console.log('모듈이 초기화되어 기본 변환 핸들러 무시');
                    return;
                }
                
                const fileInput = document.getElementById('file-input');
                const outputFormat = document.getElementById('output-format').value;
                
                if (!fileInput.files[0]) {
                    alert('파일을 선택해주세요.');
                    return;
                }
                
                if (!outputFormat) {
                    alert('출력 형식을 선택해주세요.');
                    return;
                }
                
                // 이미지 변환 폴백
                if (fileInput.files[0].type.startsWith('image/') && ['png', 'jpg', 'jpeg', 'webp'].includes(outputFormat)) {
                    convertImage(fileInput.files[0], outputFormat);
                } else {
                    showConversionError('브라우저에서 현재 지원하지 않는 변환 형식입니다.');
                }
            });
        }
        
        // 기본 이미지 변환 함수
        function convertImage(file, format) {
            const reader = new FileReader();
            const resultContainer = document.getElementById('conversion-result');
            
            // 변환 중 상태 표시
            resultContainer.classList.remove('hidden');
            resultContainer.innerHTML = `
                <div class="my-4 p-4 bg-blue-100 rounded-lg text-center">
                    <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600 mr-2"></div>
                    <span class="text-blue-800 font-medium">이미지 변환 중...</span>
                </div>
            `;
            
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // 캔버스 생성
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    
                    // 이미지 그리기
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    
                    // 형식에 따른 MIME 타입
                    let mimeType = 'image/png';
                    if (format === 'jpg' || format === 'jpeg') mimeType = 'image/jpeg';
                    else if (format === 'webp') mimeType = 'image/webp';
                    
                    // 데이터 URL 생성
                    const dataUrl = canvas.toDataURL(mimeType, 0.92);
                    
                    // 결과 표시
                    resultContainer.innerHTML = `
                        <h2 class="text-xl font-semibold mb-4">변환 완료</h2>
                        <div class="mb-6 p-4 border rounded-md">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h3 class="font-medium">${file.name.replace(/\.[^/.]+$/, '.' + format)}</h3>
                                    <p class="text-sm text-gray-500">형식: ${mimeType}</p>
                                </div>
                                <div class="flex space-x-2">
                                    <a href="${dataUrl}" download="${file.name.replace(/\.[^/.]+$/, '.' + format)}" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md">다운로드</a>
                                </div>
                            </div>
                        </div>
                        <div class="text-center">
                            <button id="convert-another-btn" class="text-blue-600 hover:underline">다른 파일 변환하기</button>
                        </div>
                    `;
                    
                    // 다른 파일 변환 버튼
                    document.getElementById('convert-another-btn')?.addEventListener('click', function() {
                        resultContainer.classList.add('hidden');
                        document.getElementById('file-input').value = '';
                    });
                };
                
                img.onerror = function() {
                    showConversionError('이미지 로드 중 오류가 발생했습니다.');
                };
                
                img.src = e.target.result;
            };
            
            reader.onerror = function() {
                showConversionError('파일 읽기 중 오류가 발생했습니다.');
            };
            
            reader.readAsDataURL(file);
        }
        
        // 변환 오류 표시
        function showConversionError(message) {
            const resultContainer = document.getElementById('conversion-result');
            resultContainer.classList.remove('hidden');
            resultContainer.innerHTML = `
                <div class="my-4 p-4 bg-red-100 rounded-lg">
                    <h3 class="text-red-800 font-medium mb-2">변환 실패</h3>
                    <p>${message}</p>
                </div>
                <div class="text-center mt-4">
                    <button id="convert-another-btn" class="text-blue-600 hover:underline">다른 파일 변환하기</button>
                </div>
            `;
            
            // 다른 파일 변환 버튼
            document.getElementById('convert-another-btn')?.addEventListener('click', function() {
                resultContainer.classList.add('hidden');
                document.getElementById('file-input').value = '';
            });
        }
    });
    </script>
    
    <!-- 사용자 경험 분석 -->
    <script src="assets/js/utils/usage-analytics.js"></script>
</body>
</html> 