<!-- 
  헤더 컴포넌트 - FileToQR 애플리케이션 (리디자인)
  UI 테마 가이드(.ai-guides/code/ui-theme-guide.md) 준수
-->
<header class="bg-white/90 backdrop-blur shadow-md sticky top-0 z-50 border-b border-slate-200">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
        <a href="/ko/index.html" class="flex items-center min-w-0 group">
            <img src="/assets/images/logo.svg" alt="FileToQR 로고" class="h-9 mr-2 shrink-0 transition-transform duration-200 group-hover:scale-105">
            <span class="text-2xl font-bold text-blue-600 tracking-tight whitespace-nowrap">FileToQR</span>
        </a>
        <!-- 햄버거 메뉴 버튼: 모바일/좁은 화면에서만 보임 -->
        <button class="md:hidden ml-2 p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 hover:bg-blue-50 transition-colors duration-150" id="mobile-menu-toggle" aria-label="메뉴 열기" aria-expanded="false" aria-controls="mobile-menu">
            <svg class="h-6 w-6 text-slate-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>
        <!-- PC 네비게이션: 넓은 화면에서만 보임 -->
        <nav class="hidden md:flex items-center flex-1 justify-center min-w-0 overflow-x-auto" aria-label="주요 메뉴">
            <ul class="flex space-x-4 md:space-x-7 min-w-0 overflow-x-auto">
                <li><a href="#" data-i18n-url="home" class="nav-link">홈</a></li>
                <li><a href="#" data-i18n-url="convert" class="nav-link">파일 변환</a></li>
                <li><a href="#" data-i18n-url="qrcode" class="nav-link">QR 코드</a></li>
                <li><a href="#" data-i18n-url="timer" class="nav-link">타이머</a></li>
                <li><a href="#" data-i18n-url="help" class="nav-link">도움말</a></li>
                <li><a href="#" data-i18n-url="game" class="nav-link">게임</a></li>
            </ul>
        </nav>
        <!-- 언어 선택기 -->
        <div class="ml-2 flex-shrink-0">
            <div class="language-selector dropdown">
                <button class="lang-dropdown-btn flex items-center gap-1 px-2 py-1 rounded hover:bg-slate-100 transition-colors duration-150" id="lang-selector-toggle" aria-label="언어 변경" aria-haspopup="listbox" aria-controls="lang-dropdown-menu" aria-expanded="false">
                    <span class="lang-flag-icon ko-flag" aria-hidden="true"></span>
                    <span class="lang-label text-slate-700 text-sm font-medium" data-i18n="lang.ko">한국어</span>
                    <svg class="lang-dropdown-arrow ml-1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <div class="lang-dropdown-content mt-2 shadow-lg rounded-lg bg-white ring-1 ring-slate-200" id="lang-dropdown-menu" role="menu" aria-hidden="true">
                    <div class="lang-dropdown-header px-4 py-2 border-b border-slate-100 text-xs text-slate-500">언어 선택</div>
                    <div class="lang-dropdown-list py-2">
                        <a href="/ko/index.html" class="lang-option active flex items-center gap-2 px-4 py-1.5 text-blue-600 bg-blue-50 rounded font-semibold" data-lang="ko" role="menuitem" aria-label="한국어" aria-current="true">
                            <span class="lang-flag-icon ko-flag" aria-hidden="true"></span>
                            <span class="lang-name" data-i18n="lang.ko">한국어</span>
                        </a>
                        <a href="/en/index.html" class="lang-option flex items-center gap-2 px-4 py-1.5 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors duration-150" data-lang="en" role="menuitem" aria-label="영어" aria-current="false">
                            <span class="lang-flag-icon en-flag" aria-hidden="true"></span>
                            <span class="lang-name" data-i18n="lang.en">영어</span>
                        </a>
                        <a href="/zh/index.html" class="lang-option flex items-center gap-2 px-4 py-1.5 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors duration-150" data-lang="zh" role="menuitem" aria-label="중국어" aria-current="false">
                            <span class="lang-flag-icon zh-flag" aria-hidden="true"></span>
                            <span class="lang-name" data-i18n="lang.zh">중국어</span>
                        </a>
                        <a href="/ja/index.html" class="lang-option flex items-center gap-2 px-4 py-1.5 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors duration-150" data-lang="ja" role="menuitem" aria-label="일본어" aria-current="false">
                            <span class="lang-flag-icon ja-flag" aria-hidden="true"></span>
                            <span class="lang-name" data-i18n="lang.ja">일본어</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 모바일 메뉴: 햄버거 클릭 시 아래로 드롭다운 -->
    <nav class="md:hidden mt-2 px-2" id="mobile-menu" style="display:none;" aria-label="모바일 메뉴">
        <ul class="flex flex-col space-y-2 bg-white rounded-lg shadow-md p-4">
            <li><a href="#" data-i18n-url="home" class="nav-link">홈</a></li>
            <li><a href="#" data-i18n-url="convert" class="nav-link">파일 변환</a></li>
            <li><a href="#" data-i18n-url="qrcode" class="nav-link">QR 코드</a></li>
            <li><a href="#" data-i18n-url="timer" class="nav-link">타이머</a></li>
            <li><a href="#" data-i18n-url="help" class="nav-link">도움말</a></li>
            <li><a href="#" data-i18n-url="game" class="nav-link">게임</a></li>
        </ul>
    </nav>
</header>

<!-- 헤더 네비게이션 스타일(활성/비활성) 및 JS -->
<style>
    .nav-link {
        @apply text-slate-700 font-medium px-3 py-1.5 rounded transition-colors duration-150 hover:text-blue-600 hover:bg-blue-50;
    }
    .nav-link.active, .nav-link[aria-current="page"] {
        @apply text-blue-600 bg-blue-50 font-bold shadow-sm;
    }
    /* 언어 드롭다운을 헤더 내에서 absolute로 띄우고, z-index를 충분히 높게 설정 */
    .language-selector {
        position: relative;
    }
    .lang-dropdown-content {
        position: absolute;
        top: 110%;
        right: 0;
        min-width: 180px;
        z-index: 1000;
        box-shadow: 0 8px 24px rgba(30,41,59,0.10), 0 1.5px 4px rgba(30,41,59,0.08);
        display: none;
    }
    .language-selector.open .lang-dropdown-content {
        display: block;
        animation: fadeIn 0.18s cubic-bezier(0.4,0,0.2,1);
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-8px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
<script>
    window.FileToQR = window.FileToQR || {};
    window.FileToQR.Header = window.FileToQR.Header || {};
    window.FileToQR.Header.initializeMobileMenuToggle = function() {
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        if (mobileMenuToggle && mobileMenu) {
            mobileMenuToggle.addEventListener('click', function() {
                const isOpen = mobileMenu.style.display === 'block';
                mobileMenu.style.display = isOpen ? 'none' : 'block';
                mobileMenuToggle.setAttribute('aria-expanded', !isOpen);
            });
            window.addEventListener('resize', function() {
                if (window.innerWidth >= 768) {
                    mobileMenu.style.display = 'none';
                    mobileMenuToggle.setAttribute('aria-expanded', 'false');
                }
            });
        }
    };
    window.FileToQR.Header.activateNavLinks = function() {
        const currentPath = window.location.pathname;
        const navLinks = document.querySelectorAll('header nav a'); 
        navLinks.forEach(link => {
            const href = link.getAttribute('href');
            const i18nUrlKey = link.dataset.i18nUrl;
            if (href && href !== '#' && i18nUrlKey) {
                const pageMapEntry = window.FileToQR.PageManager.getPageMapEntryByI18nKey(i18nUrlKey);
                let targetPath = pageMapEntry ? pageMapEntry.path : null;
                if (targetPath) {
                    const targetFileName = targetPath.substring(targetPath.lastIndexOf('/') + 1);
                    const currentFileName = currentPath.substring(currentPath.lastIndexOf('/') + 1);
                    if (currentPath.endsWith(targetPath) || (currentFileName === targetFileName)) {
                        link.classList.add('active');
                        if (link.parentElement && link.parentElement.tagName === 'LI') {
                            link.parentElement.classList.add('active');
                        }
                    } else {
                        link.classList.remove('active');
                        if (link.parentElement && link.parentElement.tagName === 'LI') {
                            link.parentElement.classList.remove('active');
                        }
                    }
                }
            }
        });
    };
</script> 